# Mainteiner: GrayJack <gr41.j4ck@gmail.com>

pkgname=cutter-radare
pkgver=1.4
pkgrel=2
pkgdesc="Qt and C++ GUI for radare2 reverse engineering framework"
_pkgradarever=2.5.0
url="https://github.com/radareorg/cutter"
arch=('x86_64')
license=('GPL3')
depends=('radare2' 'capstone' 'qt5-base' 'qt5-svg' 'icu')
makedepends=('git' 'qt5-tools')
provides=('cutter-radare')
conflicts=('radare2-cutter' 'radare2-cutter-git')
source=("https://github.com/radareorg/cutter/archive/v${pkgver}.tar.gz"
        "https://github.com/radare/radare2/archive/${_pkgradarever}.tar.gz")
sha256sums=('f2fff960ea102fc8cf7d62fe25ee2c992b2e19857a4f6a2e308b3c9cba93e5b8'
            'c795c2062c01dbb6ca91d44812cdd8600fc502264ab87ce864a97769227db796')

prepare() {
    cp -R "${srcdir}/radare2-${_pkgradarever}/" "${srcdir}/radare2"
    mv "${srcdir}/radare2" "${srcdir}/cutter-${pkgver}/"
}

build() {
    cd "${srcdir}/cutter-${pkgver}/radare2/"
    ./sys/build.sh
    cd "${srcdir}/cutter-${pkgver}"
    mkdir build
    cd "build"
    qmake ../src/Cutter.pro
    make -j4
}

package() {
    cd "${srcdir}/cutter-${pkgver}"
    install -DTm 755 build/Cutter "${pkgdir}/usr/bin/cutter"
    install -DTm 644 src/Cutter.desktop "${pkgdir}/usr/share/applications/cutter.desktop"
    install -DTm 644 src/img/cutter.svg "${pkgdir}/usr/share/icons/hicolor/scalable/apps/cutter.svg"
    install -dm755 docs/ "${pkgdir}/usr/share/doc/${pkgname}/"
    cp -a docs/* "${pkgdir}/usr/share/doc/${pkgname}/"
}
