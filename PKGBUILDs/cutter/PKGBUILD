# Mainteiner: GrayJack <gr41.j4ck@gmail.com>

pkgname=cutter
pkgver=1.1
pkgrel=1
pkgdesc='Qt and C++ GUI for radare2 reverse engineering framework'
url='https://github.com/radareorg/cutter'
arch=('x86_64')
license=('GPL3')
depends=('radare2' 'capstone' 'qt5-base' 'qt5-svg' 'icu')
makedepends=('git' 'qt5-tools')
optdepends=()
_pkgradarever=2.2.0
provides=('cutter')
source=("https://github.com/radareorg/cutter/archive/v${pkgver}.tar.gz"
        "https://github.com/radare/radare2/archive/${_pkgradarever}.tar.gz")
sha256sums=('ed1be7778f6a733343d4628a0ba2598f6c3f521e08c6d45289a58c2313e2297b'
            '99ba2a7c4aae99ae0c70ce0423fa6ed2344fb94a45bc83bf6c8716e2b3e7f1bf')

prepare() {
    mv "${srcdir}/radare2-${_pkgradarever}/" "${srcdir}/radare2"
    mv "${srcdir}/radare2" "${srcdir}/${pkgname}-${pkgver}/"
}

build() {
    cd "${srcdir}/${pkgname}-${pkgver}/radare2/"
    ./sys/build.sh
    cd "${srcdir}/${pkgname}-${pkgver}"
    mkdir build
    cd "build"
    qmake ../src
    make
}

package() {
    cd "${srcdir}/${pkgname}-${pkgver}"
    install -DTm 755 build/cutter "${pkgdir}/usr/bin/cutter"
    install -DTm 644 src/cutter.desktop "${pkgdir}/usr/share/applications/cutter.desktop"
    install -DTm 644 src/img/cutter.svg "${pkgdir}/usr/share/icons/hicolor/scalable/apps/cutter.svg"
    install -dm755 docs/ "${pkgdir}/usr/share/doc/${pkgname}/"
    cp -a docs/* "${pkgdir}/usr/share/doc/${pkgname}/"
}
